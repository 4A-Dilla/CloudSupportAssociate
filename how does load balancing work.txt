how does load balancing work.txt

Load-Balancing

When a router learns multiple routes to a specific network via multiple routing processes (or routing protocols, such as RIP, RIPv2, IGRP, EIGRP, and OSPF), it installs the route with the lowest administrative distance in the routing table. Refer to Route Selection in Cisco Routers for more information.
Sometimes the router must select a route from among many learned via the same routing process with the same administrative distance. In this case, the router chooses the path with the lowest cost (or metric) to the destination. Each routing process calculates its cost differently and the costs may need to be manipulated in order to achieve load-balancing.
If the router receives and installs multiple paths with the same administrative distance and cost to a destination, load-balancing can occur. The number of paths used is limited by the number of entries the routing protocol puts in the routing table. Four entries is the default in IOS for most IP routing protocols with the exception of Border Gateway Protocol (BGP), where one entry is the default. Six different paths configured is the maximum number.
The IGRP and EIGRP routing processes also support unequal cost load-balancing. You can use the variance command with IGRP and EIGRP to accomplish unequal cost load-balancing. Issue the maximum-paths command in order to determine the number of routes that can be installed based on the value configured for the protocol. If you set the routing table to one entry, it disables load balancing. Refer to How Does Unequal Cost Path Load-Balancing (Variance) Work in IGRP and EIGRP? for more information about variance.
You can usually use the show ip route command to find equal cost routes. For example, below is the show ip route command output to a particular subnet that has multiple routes. Notice there are two routing descriptor blocks. Each block is one route. There is also an asterisk (*) next to one of the block entries. This corresponds to the active route that is used for new traffic. The term 'new traffic' corresponds to a single packet or an entire flow to a destination, depending on the type of switching configured.
For process-switching—load balancing is on a per-packet basis and the asterisk (*) points to the interface over which the next packet is sent.
For fast-switching—load balancing is on a per-destination basis and the asterisk (*) points to the interface over which the next destination-based flow is sent.




To address the need for high availability and scalability, networks often use multiple parallel links. To provide aggregate bandwidth greater than that available with a single link, parallel links are used. Load balancing occurs when traffic destined to a network is forwarded over multiple parallel paths. Routers prefer routes learned through protocols with lower administrative distance. For load balancing to work, the parallel routes are learned through a single routing protocol. This protocol should have the least administrative distance among all the routing protocols running on the router. These multiple routes to a destination are compared by their metrics, and the shortest path is installed in the routing table. If there is more than one path with the same least metric value, all least-metric routes are installed in the routing table. Some protocols, such as Enhanced Interior Gateway Routing Protocol (EIGRP), can be configured to install multiple paths. This may occur even if the paths are not of equal metric. To determine the number of routes that be installed based on the value configured for the protocol, issue the maximum-paths command. The maximum number of parallel paths installed is Cisco IOS Software and protocol dependent. Once multiple paths are installed, routers will load balance on the paths on a per-packet or per-destination basis. A router load balancing on a per-packet basis uses the parallel paths in a round-robin fashion, only forwarding a single packet on a path before moving on to the next one. A router load balancing on a per-destination basis uses the parallel routes in a round-robin fashion, but forwards an entire destination-based flow in each pass. Per-packet or per-destination load balancing is dependent on the switching mechanism configured on the interface. Interfaces configured for process switching load balance on a per-packet basis. Interfaces configured for fast or optimum switching load balance on a per-destination basis. Meanwhile, interfaces configured for Cisco Express Forwarding (CEF) can load balance on a per-packet basis or per-source-destination basis.